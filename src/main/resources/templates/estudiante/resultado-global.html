<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resultado Global - Saber TyT</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/admin.css}">
</head>

<body>

<div class="container-fluid">
    <div class="row">

        <!-- SIDEBAR ESTUDIANTE -->
        <nav class="col-md-2 sidebar p-3">
            <h4 class="mb-4">üéì Mi Panel</h4>
            
            <div class="nav flex-column">
                <a th:href="@{/estudiante/dashboard}">üìä Dashboard</a>
                <a th:href="@{/estudiante/identificacion}">üÜî Identificaci√≥n</a>
                <a th:href="@{/estudiante/resultado-global}" class="active">üéØ Resultado Global</a>
                <a th:href="@{/estudiante/resultados-asignaturas}">üìö Resultados por Asignatura</a>
                <a th:href="@{/estudiante/beneficio}">üéÅ Mi Beneficio</a>
                <a th:href="@{/estudiante/comparacion}">üìà Comparaci√≥n</a>
                <hr class="bg-white my-3">
                <a th:href="@{/logout}" class="text-danger">üö™ Cerrar Sesi√≥n</a>
            </div>
        </nav>

        <!-- CONTENIDO PRINCIPAL -->
        <div class="col-md-10 p-4">
            
            <!-- BREADCRUMB -->
            <nav aria-label="breadcrumb" class="mb-3">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a th:href="@{/estudiante/dashboard}">Dashboard</a></li>
                    <li class="breadcrumb-item active">Resultado Global</li>
                </ol>
            </nav>

            <!-- HEADER -->
            <div class="mb-4">
                <h2>üéØ Mi Resultado Global Saber TyT</h2>
                <p class="text-muted">Puntaje general obtenido en la prueba</p>
            </div>

            <!-- TARJETA PUNTAJE PRINCIPAL -->
            <div class="card shadow-lg mb-4">
                <div class="card-header bg-success text-white">
                    <h5 class="mb-0">üìä Puntaje Global</h5>
                </div>
                <div class="card-body">
                    <div class="row align-items-center">
                        <div class="col-md-6 text-center border-end">
                            <p class="text-muted mb-2">Mi Puntaje Global</p>
                            <h1 class="display-1 fw-bold mb-3" 
                                th:text="${estudiante.puntajeSaberPro}"
                                th:style="${estudiante.puntajeSaberPro >= 171} ? 'color: #28a745; font-size: 7rem;' : 
                                          (${estudiante.puntajeSaberPro >= 151} ? 'color: #ffc107; font-size: 7rem;' : 
                                          (${estudiante.puntajeSaberPro >= 120} ? 'color: #007bff; font-size: 7rem;' : 'color: #6c757d; font-size: 7rem;'))">
                                200
                            </h1>
                            <p class="lead mb-2">de 200 puntos posibles</p>
                            <p class="text-muted"><small>Escala Nacional Saber TyT</small></p>
                            <span class="badge fs-5 px-4 py-2 mt-3" 
                                  th:classappend="${estudiante.puntajeSaberPro >= 171} ? 'bg-success' : 
                                                 (${estudiante.puntajeSaberPro >= 151} ? 'bg-warning text-dark' : 
                                                 (${estudiante.puntajeSaberPro >= 120} ? 'bg-primary' : 'bg-secondary'))"
                                  th:text="${estudiante.nivelSaberPro}">
                                Nivel 4
                            </span>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-4">
                                <div class="d-flex justify-content-between mb-2">
                                    <span><strong>Mi Puntaje</strong></span>
                                    <span class="badge bg-primary fs-5" th:text="${estudiante.puntajeSaberPro}">200</span>
                                </div>
                                <div class="progress" style="height: 35px;">
                                    <div class="progress-bar bg-success" 
                                         th:style="'width: ' + (${estudiante.puntajeSaberPro} * 100.0 / 200) + '%;'"
                                         th:text="${estudiante.puntajeSaberPro}">
                                    </div>
                                </div>
                            </div>

                            <div class="mb-4">
                                <div class="d-flex justify-content-between mb-2">
                                    <span><strong>Promedio del Grupo</strong></span>
                                    <span class="badge bg-secondary fs-5" th:text="${promedioTexto}">142.5</span>
                                </div>
                                <div class="progress" style="height: 35px;">
                                    <div class="progress-bar bg-warning" 
                                         th:style="'width: ' + (${promedioInt} * 100.0 / 200) + '%;'"
                                         th:text="${promedioTexto}">
                                    </div>
                                </div>
                            </div>

                            <div class="alert alert-info mb-0">
                                <strong>üìä An√°lisis Comparativo:</strong>
                                <p class="mb-2" th:if="${estudiante.puntajeSaberPro >= promedioInt}">
                                    ‚úÖ Tu puntaje est√° <strong>por encima</strong> del promedio del grupo.
                                </p>
                                <p class="mb-2" th:unless="${estudiante.puntajeSaberPro >= promedioInt}">
                                    ‚ö†Ô∏è Tu puntaje est√° por debajo del promedio del grupo.
                                </p>
                                <p class="mb-0">
                                    <strong>Diferencia:</strong> 
                                    <span th:text="${#numbers.formatDecimal(estudiante.puntajeSaberPro - promedioInt, 0, 1)}">+57.5</span> puntos
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- CONTEXTO ESTAD√çSTICO -->
            <div class="row g-3 mb-4">
                <div class="col-md-3">
                    <div class="card text-center h-100 shadow">
                        <div class="card-body">
                            <h6 class="text-muted">üèÜ Puntaje M√°ximo</h6>
                            <h2 class="text-success mb-0" th:text="${maximo}">200</h2>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-center h-100 shadow">
                        <div class="card-body">
                            <h6 class="text-muted">üìä Promedio</h6>
                            <h2 class="text-warning mb-0" th:text="${promedioTexto}">142.5</h2>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-center h-100 shadow">
                        <div class="card-body">
                            <h6 class="text-muted">üìâ Puntaje M√≠nimo</h6>
                            <h2 class="text-danger mb-0" th:text="${minimo}">96</h2>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-center h-100 shadow">
                        <div class="card-body">
                            <h6 class="text-muted">üë• Total Estudiantes</h6>
                            <h2 class="text-primary mb-0" th:text="${totalEstudiantes}">34</h2>
                        </div>
                    </div>
                </div>
            </div>

            <!-- INTERPRETACI√ìN DEL RESULTADO -->
            <div class="card shadow-lg mb-4">
                <div class="card-header bg-info text-white">
                    <h5 class="mb-0">üí° Interpretaci√≥n de tu Resultado</h5>
                </div>
                <div class="card-body">
                    <div th:if="${estudiante.puntajeSaberPro >= 171}" class="alert alert-success">
                        <h5 class="alert-heading">üåü ¬°Excelente Desempe√±o!</h5>
                        <hr>
                        <ul class="mb-0">
                            <li>Has alcanzado el <strong>nivel m√°s alto (Nivel 4)</strong> en la prueba Saber TyT</li>
                            <li>Tu puntaje te ubica en el <strong>rango superior</strong> a nivel nacional</li>
                            <li>Demuestras competencias sobresalientes en todas las √°reas evaluadas</li>
                            <li>Calificas para los <strong>m√°ximos beneficios institucionales</strong></li>
                        </ul>
                    </div>

                    <div th:if="${estudiante.puntajeSaberPro >= 151 && estudiante.puntajeSaberPro < 171}" class="alert alert-warning">
                        <h5 class="alert-heading">‚≠ê ¬°Muy Buen Desempe√±o!</h5>
                        <hr>
                        <ul class="mb-0">
                            <li>Has alcanzado el <strong>Nivel 3</strong> en la prueba Saber TyT</li>
                            <li>Tu desempe√±o est√° <strong>por encima del promedio nacional</strong></li>
                            <li>Demuestras competencias notables en las √°reas evaluadas</li>
                            <li>Calificas para <strong>beneficios institucionales significativos</strong></li>
                        </ul>
                    </div>

                    <div th:if="${estudiante.puntajeSaberPro >= 120 && estudiante.puntajeSaberPro < 151}" class="alert alert-primary">
                        <h5 class="alert-heading">‚úÖ Buen Desempe√±o</h5>
                        <hr>
                        <ul class="mb-0">
                            <li>Has alcanzado el <strong>Nivel 2</strong> en la prueba Saber TyT</li>
                            <li>Tu desempe√±o es <strong>satisfactorio</strong> seg√∫n est√°ndares nacionales</li>
                            <li>Cumples con los requisitos acad√©micos establecidos</li>
                            <li>Calificas para <strong>beneficios institucionales b√°sicos</strong></li>
                        </ul>
                    </div>

                    <div th:if="${estudiante.puntajeSaberPro >= 80 && estudiante.puntajeSaberPro < 120}" class="alert alert-secondary">
                        <h5 class="alert-heading">üìå Desempe√±o B√°sico</h5>
                        <hr>
                        <ul class="mb-0">
                            <li>Has alcanzado el <strong>Nivel 1</strong> en la prueba Saber TyT</li>
                            <li>Cumples con el <strong>requisito m√≠nimo</strong> para graduaci√≥n</li>
                            <li>No calificas para incentivos institucionales en este momento</li>
                            <li>Se recomienda fortalecer competencias para futuras evaluaciones</li>
                        </ul>
                    </div>

                    <div th:if="${estudiante.puntajeSaberPro < 80}" class="alert alert-danger">
                        <h5 class="alert-heading">‚ö†Ô∏è Atenci√≥n Importante</h5>
                        <hr>
                        <ul class="mb-0">
                            <li><strong>No cumples</strong> con el requisito m√≠nimo de graduaci√≥n UTS</li>
                            <li>Debes presentar <strong>nuevamente</strong> la prueba Saber TyT</li>
                            <li>Contacta a tu coordinador acad√©mico para orientaci√≥n</li>
                            <li>Es obligatorio alcanzar al menos <strong>80 puntos</strong> para graduarte</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- ESCALA DE DESEMPE√ëO -->
            <div class="card shadow-lg mb-4">
                <div class="card-header bg-dark text-white">
                    <h5 class="mb-0">üìè Escala de Desempe√±o Nacional</h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-bordered">
                            <thead class="table-light">
                                <tr>
                                    <th>Nivel</th>
                                    <th>Rango</th>
                                    <th>Clasificaci√≥n</th>
                                    <th>Descripci√≥n</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr th:classappend="${estudiante.puntajeSaberPro >= 171} ? 'table-success fw-bold' : ''">
                                    <td>Nivel 4</td>
                                    <td>171 - 200</td>
                                    <td><span class="badge bg-success">Excelente</span></td>
                                    <td>Desempe√±o sobresaliente en todas las competencias</td>
                                </tr>
                                <tr th:classappend="${estudiante.puntajeSaberPro >= 151 && estudiante.puntajeSaberPro < 171} ? 'table-warning fw-bold' : ''">
                                    <td>Nivel 3</td>
                                    <td>151 - 170</td>
                                    <td><span class="badge bg-warning text-dark">Muy Bueno</span></td>
                                    <td>Desempe√±o notable por encima del promedio</td>
                                </tr>
                                <tr th:classappend="${estudiante.puntajeSaberPro >= 120 && estudiante.puntajeSaberPro < 151} ? 'table-primary fw-bold' : ''">
                                    <td>Nivel 2</td>
                                    <td>120 - 150</td>
                                    <td><span class="badge bg-primary">Bueno</span></td>
                                    <td>Desempe√±o satisfactorio en las competencias</td>
                                </tr>
                                <tr th:classappend="${estudiante.puntajeSaberPro >= 80 && estudiante.puntajeSaberPro < 120} ? 'table-secondary fw-bold' : ''">
                                    <td>Nivel 1</td>
                                    <td>80 - 119</td>
                                    <td><span class="badge bg-secondary">B√°sico</span></td>
                                    <td>Desempe√±o b√°sico cumple requisitos m√≠nimos</td>
                                </tr>
                                <tr th:classappend="${estudiante.puntajeSaberPro < 80} ? 'table-danger fw-bold' : ''">
                                    <td>Sin Nivel</td>
                                    <td>< 80</td>
                                    <td><span class="badge bg-danger">Insuficiente</span></td>
                                    <td>No cumple requisitos para graduaci√≥n</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- BOT√ìN REGRESAR -->
            <div class="text-center">
                <a th:href="@{/estudiante/dashboard}" class="btn btn-primary btn-lg">
                    ‚Üê Volver al Dashboard
                </a>
            </div>

        </div>

    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<style>
    .sidebar a.active {
        background: linear-gradient(90deg, #c0d72c, #a5c31f);
        color: #000;
        font-weight: bold;
    }
</style>

</body>
</html>