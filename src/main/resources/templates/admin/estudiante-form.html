<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="es">

<head th:replace="layout/admin-layout :: head('Formulario Estudiante')"></head>

<body>

<div class="container-fluid">
    <div class="row">

        <!-- SIDEBAR -->
        <div th:replace="layout/admin-layout :: sidebar"></div>

        <!-- CONTENIDO PRINCIPAL -->
        <div class="col-md-10 p-4">
            
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h3 th:text="${modoEdicion} ? '‚úèÔ∏è Editar Estudiante' : '‚ûï Registrar Nuevo Estudiante'">
                    ‚ûï Registrar Nuevo Estudiante
                </h3>
                <a th:href="@{/admin/estudiantes}" class="btn btn-secondary">
                    ‚¨ÖÔ∏è Volver a la Lista
                </a>
            </div>

            <!-- MENSAJES -->
            <div th:if="${success}" class="alert alert-success alert-dismissible fade show" role="alert">
                <span th:text="${success}"></span>
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>
            
            <div th:if="${error}" class="alert alert-danger alert-dismissible fade show" role="alert">
                <span th:text="${error}"></span>
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>

            <!-- FORMULARIO -->
            <form th:action="@{/admin/estudiantes/guardar}" method="post" th:object="${estudiante}">
                
                <input type="hidden" th:field="*{id}" />

                <!-- DATOS PERSONALES -->
                <div class="card mb-4">
                    <div class="card-header bg-primary text-white">
                        <h5 class="mb-0">üìã Datos Personales</h5>
                    </div>
                    <div class="card-body">
                        <div class="row g-3">
                            
                            <div class="col-md-3">
                                <label class="form-label">Tipo de Documento <span class="text-danger">*</span></label>
                                <select class="form-select" th:field="*{tipoDocumento}" required>
                                    <option value="">Seleccione...</option>
                                    <option value="CC">CC - C√©dula de Ciudadan√≠a</option>
                                    <option value="TI">TI - Tarjeta de Identidad</option>
                                    <option value="CE">CE - C√©dula de Extranjer√≠a</option>
                                    <option value="PAS">PAS - Pasaporte</option>
                                </select>
                            </div>

                            <div class="col-md-3">
                                <label class="form-label">N√∫mero de Documento</label>
                                <input type="text" class="form-control" th:field="*{numeroDocumento}" 
                                       placeholder="Ej: 1098765432">
                            </div>

                            <div class="col-md-6">
                                <label class="form-label">N√∫mero de Registro <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" th:field="*{numeroRegistro}" 
                                       placeholder="Ej: EK20183007722" required>
                                <small class="text-muted">C√≥digo del ICFES</small>
                            </div>

                            <div class="col-md-3">
                                <label class="form-label">Primer Apellido <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" th:field="*{primerApellido}" 
                                       placeholder="Ej: GARC√çA" required style="text-transform: uppercase;">
                            </div>

                            <div class="col-md-3">
                                <label class="form-label">Segundo Apellido</label>
                                <input type="text" class="form-control" th:field="*{segundoApellido}" 
                                       placeholder="Ej: L√ìPEZ" style="text-transform: uppercase;">
                            </div>

                            <div class="col-md-3">
                                <label class="form-label">Primer Nombre</label>
                                <input type="text" class="form-control" th:field="*{primerNombre}" 
                                       placeholder="Ej: JUAN" style="text-transform: uppercase;">
                            </div>

                            <div class="col-md-3">
                                <label class="form-label">Segundo Nombre</label>
                                <input type="text" class="form-control" th:field="*{segundoNombre}" 
                                       placeholder="Ej: CARLOS" style="text-transform: uppercase;">
                            </div>

                            <div class="col-md-6">
                                <label class="form-label">Correo Electr√≥nico</label>
                                <input type="email" class="form-control" th:field="*{correoElectronico}" 
                                       placeholder="estudiante@ejemplo.com">
                            </div>

                            <div class="col-md-3">
                                <label class="form-label">N√∫mero Telef√≥nico</label>
                                <input type="tel" class="form-control" th:field="*{numeroTelefonico}" 
                                       placeholder="3001234567">
                            </div>

                            <div class="col-md-3">
                                <label class="form-label">Estado <span class="text-danger">*</span></label>
                                <select class="form-select" th:field="*{estado}" required>
                                    <option value="ACTIVO">‚úÖ ACTIVO</option>
                                    <option value="ANULADO">üö´ ANULADO</option>
                                </select>
                            </div>

                        </div>
                    </div>
                </div>

                <!-- COMPETENCIAS B√ÅSICAS -->
                <div class="card mb-4">
                    <div class="card-header bg-success text-white">
                        <h5 class="mb-0">üìä Competencias B√°sicas</h5>
                        <small>Los niveles se calculan autom√°ticamente seg√∫n el puntaje</small>
                    </div>
                    <div class="card-body">
                        <div class="row g-3">
                            
                            <div class="col-md-3">
                                <label class="form-label">‚úçÔ∏è Comunicaci√≥n Escrita</label>
                                <input type="number" class="form-control" th:field="*{comunicacionEscrita}" 
                                       placeholder="0-250" min="0" max="250">
                                <small class="text-muted">Nivel 4: ‚â•180 | Nivel 3: ‚â•150 | Nivel 2: ‚â•120</small>
                            </div>

                            <div class="col-md-3">
                                <label class="form-label">üî¢ Razonamiento Cuantitativo</label>
                                <input type="number" class="form-control" th:field="*{razonamientoCuantitativo}" 
                                       placeholder="0-250" min="0" max="250">
                                <small class="text-muted">Nivel 4: ‚â•180 | Nivel 3: ‚â•150 | Nivel 2: ‚â•120</small>
                            </div>

                            <div class="col-md-3">
                                <label class="form-label">üìñ Lectura Cr√≠tica</label>
                                <input type="number" class="form-control" th:field="*{lecturaCritica}" 
                                       placeholder="0-250" min="0" max="250">
                                <small class="text-muted">Nivel 4: ‚â•180 | Nivel 3: ‚â•150 | Nivel 2: ‚â•120</small>
                            </div>

                            <div class="col-md-3">
                                <label class="form-label">üèõÔ∏è Competencias Ciudadanas</label>
                                <input type="number" class="form-control" th:field="*{competenciasCiudadanas}" 
                                       placeholder="0-250" min="0" max="250">
                                <small class="text-muted">Nivel 4: ‚â•180 | Nivel 3: ‚â•150 | Nivel 2: ‚â•120</small>
                            </div>

                        </div>
                    </div>
                </div>

                <!-- COMPETENCIAS ESPEC√çFICAS -->
                <div class="card mb-4">
                    <div class="card-header bg-info text-white">
                        <h5 class="mb-0">üéì Competencias Espec√≠ficas</h5>
                    </div>
                    <div class="card-body">
                        <div class="row g-3">
                            
                            <div class="col-md-3">
                                <label class="form-label">üåç Ingl√©s</label>
                                <input type="number" class="form-control" th:field="*{ingles}" 
                                       placeholder="0-250" min="0" max="250">
                                <small class="text-muted">B2: ‚â•200 | B1: ‚â•160 | A2: ‚â•130 | A1: ‚â•100</small>
                            </div>

                            <div class="col-md-3">
                                <label class="form-label">üìê Formulaci√≥n de Proyectos</label>
                                <input type="number" class="form-control" th:field="*{formulacionProyectos}" 
                                       placeholder="0-250" min="0" max="250">
                                <small class="text-muted">Nivel 4: ‚â•180 | Nivel 3: ‚â•150 | Nivel 2: ‚â•120</small>
                            </div>

                            <div class="col-md-3">
                                <label class="form-label">üî¨ Pensamiento Cient√≠fico</label>
                                <input type="number" class="form-control" th:field="*{pensamientoCientifico}" 
                                       placeholder="0-250" min="0" max="250">
                                <small class="text-muted">Nivel 4: ‚â•180 | Nivel 3: ‚â•150 | Nivel 2: ‚â•120</small>
                            </div>

                            <div class="col-md-3">
                                <label class="form-label">üíª Dise√±o de Software</label>
                                <input type="number" class="form-control" th:field="*{disenoSoftware}" 
                                       placeholder="0-250" min="0" max="250">
                                <small class="text-muted">Nivel 4: ‚â•180 | Nivel 3: ‚â•150 | Nivel 2: ‚â•120</small>
                            </div>

                        </div>
                    </div>
                </div>

                <!-- INFORMACI√ìN AUTOM√ÅTICA -->
                <div class="alert alert-info">
                    <strong>‚ÑπÔ∏è Informaci√≥n:</strong>
                    <ul class="mb-0 mt-2">
                        <li>El <strong>Puntaje Saber Pro</strong> se calcula autom√°ticamente como el promedio de todas las competencias.</li>
                        <li>Los <strong>Niveles</strong> se asignan autom√°ticamente seg√∫n los puntajes ingresados.</li>
                        <li>Los campos marcados con <span class="text-danger">*</span> son obligatorios.</li>
                    </ul>
                </div>

                <!-- BOTONES -->
                <div class="d-flex justify-content-between">
                    <a th:href="@{/admin/estudiantes}" class="btn btn-secondary btn-lg">
                        ‚ùå Cancelar
                    </a>
                    <button type="submit" class="btn btn-success btn-lg">
                        <span th:if="${modoEdicion}">üíæ Actualizar Estudiante</span>
                        <span th:unless="${modoEdicion}">‚úÖ Guardar Estudiante</span>
                    </button>
                </div>

            </form>

        </div>

    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
    // Validaci√≥n de puntajes
    document.querySelectorAll('input[type="number"]').forEach(input => {
        input.addEventListener('input', function() {
            if (this.value < 0) this.value = 0;
            if (this.value > 250) this.value = 250;
        });
    });
</script>

</body>
</html>